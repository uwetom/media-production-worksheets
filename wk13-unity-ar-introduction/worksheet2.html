<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>worksheet2</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><p><a href="https://uwetom.github.io/media-production-worksheets">Back</a></p>
<h1 id="position-virtual-object">Position Virtual Object</h1>
<p>In the previous worksheet the cube is located at the origin or our scene. This is normally where the phones camera is when you first open the app, but does not correspond to anything specifically in the real world.</p>
<p>We want to be able to decide exactly where object will appear in the real world.</p>
<h2 id="tracked-image">Tracked Image</h2>
<p>The first way we will do this is with a tracked image.</p>
<p>This allows us to link virtual 3D objects to real images.</p>
<p>This image can be anything we want, but for accurate tracking Unity recommends:</p>
<ul>
<li>Size must be at least 300 x 300 pixels.</li>
<li>Format must be PNG or JPG.</li>
<li>Image can be black and white or colour but must have strong contrast.</li>
<li>Image should avoid repeated patterns.</li>
</ul>
<p>I have created a Unity package with some simple assets in it to get us started.</p>
<p><a href="https://github.com/uwetom/media-production-worksheets/raw/refs/heads/master/wk13-unity-ar-introduction/assets/ship.unitypackage">unity ship package download</a></p>
<ul>
<li>Download it and drag it into the assets panel in Unity to include it in your project</li>
<li>Save the template scene with a new name in the scenes folder (“tracked_image_scene”)</li>
<li>Delete the cube from the scene</li>
</ul>
<h3 id="tracked-image-manager">Tracked image manager</h3>
<p>The tracked image manager component manages all the images we want to track.</p>
<iframe src="https://uwe.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=67d369cb-c479-4dc7-8732-b21f00951b6a&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=false&amp;showbrand=false&amp;captions=false&amp;interactivity=all" height="405" width="720" allowfullscreen=""></iframe>
<h3 id="instantiate-a-prefab">Instantiate a prefab</h3>
<p>Now we can create a script to instantiate our prefab on the image.</p>
<iframe src="https://uwe.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=09532d13-dd25-4ab8-8bb5-b21f0096e46c&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=false&amp;showbrand=false&amp;captions=false&amp;interactivity=all" height="405" width="720" allowfullscreen=""></iframe>
<h4 id="finished-script">Finished Script</h4>
<pre><code>using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.XR.ARFoundation; // include xr library

public class TrackImage : MonoBehaviour
{
    [SerializeField]
    ARTrackedImageManager m_TrackedImageManager; 
    public GameObject shipPrefab; //Prefab you want to appear on marker image
    
    void OnEnable() =&gt; m_TrackedImageManager.trackedImagesChanged += OnChanged;

    void OnDisable() =&gt; m_TrackedImageManager.trackedImagesChanged -= OnChanged;

    void OnChanged(ARTrackedImagesChangedEventArgs eventArgs)
    {
    	// When the camera picks up a new image marker Unity adds a game object to it called newImage, this will stick to maker.
        foreach (ARTrackedImage newImage in eventArgs.added)
        {
        	// Create new copy of your prefab
        	GameObject newObject = GameObject.Instantiate(shipPrefab);
        	// parent prefab to the newImage so that they stick together.
			newObject.transform.SetParent(newImage.transform, false);
        }
    }
}

</code></pre>
<h2 id="build-and-test-the-scene">Build and Test the Scene</h2>
<p>We can now build and test the scene again on our device.</p>
<ul>
<li>First, on your Android device delete the previous build buy holding down on it and dragging it to delete.</li>
<li>Go to <strong>File &gt; Build Settings</strong> and add the current scene, untick the old template scene.</li>
<li>Check You <strong>run device</strong> is still connected and selected and press build and run.</li>
<li>Name the build something different than before.</li>
</ul>
<p>If you point your camera at your image the model should appear.</p>
<iframe src="https://uwe.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=e3e42657-f347-4b16-909d-b21e00b86980&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=false&amp;showbrand=false&amp;captions=false&amp;interactivity=all" height="405" width="720" allowfullscreen=""></iframe>
<h2 id="virtual-environment">Virtual Environment</h2>
<p>You may not always have an Android device available for testing and as your project expands it can take a while to do a full build each time you need to test.</p>
<p>To get around this you can create a virtual environment in Unity.</p>
<iframe src="https://uwe.cloud.panopto.eu/Panopto/Pages/Embed.aspx?id=94c4dac7-3a89-45f1-a3fe-b21f00b95897&amp;autoplay=false&amp;offerviewer=true&amp;showtitle=false&amp;showbrand=false&amp;captions=false&amp;interactivity=all" height="405" width="720" allowfullscreen=""></iframe>
<h2 id="challenges">Challenges</h2>
<h3 id="add-sound">Add sound</h3>
<p>Now that we have a simple image marker scene working we can think about taking it further. In the script, after you instantiate the new prefab you can play a sounds, start an animation or a particle effect.</p>
<p>In the ship folder you can find a sound file, try to make this play when the ship is instantiated.</p>
<h4 id="solution">Solution</h4>
<ol>
<li>Add an audio source component to the xr origin.</li>
<li>Add a public AudioClip variable to your script to hold your splash sound<br>
<code>public AudioClip sound;</code><br>
3 In your script, find the Audio source component<br>
<code>AudioSource source = GetComponent&lt;AudioSource&gt;();</code><br>
4 Use it to play your sound<br>
<code>source.PlayOneShot(sound);</code></li>
</ol>
<h3 id="add-multiple-markers">Add multiple markers</h3>
<p>In the ship folder you can find two boats and 2 images. Add both images to your image reference library and add to your script to a different boat for each image.</p>
<h4 id="solution-1">Solution</h4>
<ol>
<li>Add the second image to your image library and give it a different name.</li>
<li>In your script add another public gameObject variable to hold  a different prefab.</li>
<li>In your script, you can access the name of image, use this in an if statement to check if the name matches an image in your library.<br>
<code>newImage.referenceImage.name</code></li>
<li>If it matches, instantiate the correct prefab.</li>
</ol>
</div>
</body>

</html>
